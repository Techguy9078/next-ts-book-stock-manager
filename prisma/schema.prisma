// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearchPostgres"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Book Models
model StoredBooks {
  barcode   String        @id @unique
  isbn      String
  title     String
  author    String
  genre     String        @default("n/a")
  createdAt DateTime      @default(now())
  updatedAt DateTime      @default(now()) @updatedAt
  books     ScannedBook[]
  Analytics Analytics[]

  @@unique([barcode, isbn, title, author, genre])
}

model ScannedBook {
  id        Int          @id @default(autoincrement())
  barcode   String?
  isbn      String?
  title     String?
  author    String?
  genre     String?      @default("n/a")
  park      Boolean      @default(true) // Change once current data overrided.
  book      StoredBooks? @relation(fields: [barcode, isbn, title, author, genre], references: [barcode, isbn, title, author, genre], onDelete: SetNull)
  createdAt DateTime     @default(now())
}

model Analytics {
  id                 Int          @id @default(autoincrement())
  action             Actions
  book               StoredBooks? @relation(fields: [storedBooksBarcode], references: [barcode])
  information        String?
  status             Statuses     @default(UNKNOWN)
  eventAt            DateTime     @default(now())
  storedBooksBarcode String?
}

enum Statuses {
  SUCCESS
  FAIL
  UNKNOWN
}

enum Actions {
  SCAN
  ADD
  MANUALADD
  REMOVE
  EDIT
  SEARCH
}

// Customer Request Models
model CustomerBookRequest {
  id             Int      @id @default(autoincrement())
  requestName    String
  requestNumber  String
  requestTitle   String?
  requestAuthor  String?
  requestISBN    String?
  requestComment String?
  createdAt      DateTime @default(now())
}
